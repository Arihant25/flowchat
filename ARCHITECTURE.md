# Flow Chat System Design

## Overview
Flow Chat is a next generation UI for interacting with large language models (LLMs). It provides a seamless and intuitive interface for users to engage in conversations with AI, leveraging the power of LLMs to generate human-like responses. The system is designed to be scalable, flexible, and easy to use, making it suitable for a wide range of applications.

## Tech Stack
1. **Next.js**: It is used for both the frontend and backend of the application. Next.js provides server-side rendering, static site generation, and API routes, making it a versatile choice for building web applications.
2. **ShadCN and TailwindCSS**: These are used for styling the application. ShadCN provides a set of pre-designed components, while TailwindCSS is a utility-first CSS framework that allows for rapid UI development.
3. **IndexedDB**: Since there is no account system, user data is stored using IndexedDB, a low-level API for client-side storage of significant amounts of structured data.
4. **Vercel**: The application is deployed on Vercel.
5. **AI**: The system integrates with various LLM providers, such as OpenAI, Anthropic, Google, and even local ones like Ollama, LM Studio, and more.

## Frontend
The following major components are implemented in the frontend:

0. **NavBar**: A navigation bar that is present on all pages, providing links to different sections of the application. It has a simple and clean design, ensuring easy navigation for users. It should have the Flow Chat logo on the left and navigation links on the right. The Flow Chat logo should be clickable and redirect to the landing page. The logo is just a text logo, not an image. Use appropriate font and styling to make it visually appealing.

1. **Landing Page**: This is a modern, simple, plain white or black background page, giving an overview of Flow Chat and its features. It doesn't use cards, but rather a clean layout with sections highlighting key functionalities, benefits, and use cases of the application. It includes:
   - A header with navigation links to different sections of the site.
   - A hero section with a catchy tagline and a call-to-action button to start using Flow Chat.
   - Feature sections that describe the main capabilities of the application.
   - A footer with Flow Chat logo and a link to the [GitHub repo](https://www.github.com/Arihant25/flowchat), and contact information (Made with <3 in Hyderabad).

2. **Chat Page**: This is the distinguishing feature of Flow Chat, providing a user-friendly and efficient way to communicate with AI. What makes Flow Chat unique from other chat applications is its graph UI, which allows users to visualize the flow of their conversations.

Each message is represented as a node in the graph, with edges connecting to the following and previous messages. This makes it easy to follow the conversation and understand the context of each message. So there is a pannable and zoomable canvas in the center of the page, and users can full screen it using a floating full screen button on the top right. In the beginning it is blank (the background is always subtle dots), with the text "Click anywhere to start chatting!". When the user clicks somewhere, it opens a chatbox in that area, where they can enter a prompt, and once they submit it, the response is generated by the LLM in that box. They can then click a plus button that appears on the bottom edge of the box on hover to send the next message, or they can select any part of the text and a hovering Reply button appears on that, and clicking on it opens another textbox card beside the current one where they can send another prompt specifically regarding the selected text. The prompt for that should inform the LLM so.

The user can always click on any part of the canvas to add a new card there, which starts a new conversation thread.

Hovering on a card also shows a delete icon on the top right of the card, to delete that node from the graph (and all nodes following it). This should show a dialog box confirming the user if this is what they want, with a checkbox saying "Don't ask me again".

There should also be branch icon beside the delete icon, which duplicates the entire conversation history till that point, and allows the user to edit the latest prompt before hitting send. So it creates an entirely new set of cards beside the existing set, but the user can enter a different

The page also includes a collapsible sidebar on the left for accessing chat history, allowing users to view, rename and delete past conversations. It collapses to a narrow strip with just icons, and expands when hovered over or when the hamburger menu on the top left is clicked. The sidebar also has a New Chat button at the top to start a new conversation, and a Settings icon at the bottom to navigate to the settings page. The chat history is displayed in a list format, showing the title of each conversation and the date it was last modified. Clicking on a conversation loads it into the main chat area. The sidebar should be a separate component imported in the chat page.

3. **Settings Page**: This page allows users to configure various settings related to their chat experience. It includes:
   - Options to manage LLM providers and API keys.
   - Preferences for chat behavior, such as response length, temperature, and more.
   - Theme customization options (light/dark mode, font, size, etc.).
   - Data management options, such as clearing chat history, importing/exporting all data, and importing/exporting settings.

4. **Error Handling**: The application includes robust error handling mechanisms to ensure a smooth user experience. This includes displaying user-friendly error messages as toast notifications when something goes wrong, such as network issues or invalid API keys.

5. **Responsive Design**: The frontend is designed to be fully responsive, ensuring that it works well on a variety of devices, including desktops, tablets, and smartphones.

## Backend
The backend of Flow Chat is built using Next.js API routes, which handle various functionalities such as:

1. **LLM Integration**: The backend communicates with different LLM providers to fetch responses based on user input. It handles API requests, manages authentication, and processes responses from the LLMs.

2. **Data Management**: The backend provides endpoints for managing user data stored in IndexedDB, including saving chat history, retrieving past conversations, and managing settings.

3. **Security**: The backend implements security measures to protect user data and ensure secure communication with LLM providers. This includes using HTTPS, validating API keys, and sanitizing user input to prevent injection attacks.

4. **Scalability**: The backend is designed to be scalable, allowing for easy addition of new LLM providers and models as they become available. This ensures that Flow Chat can adapt to the evolving landscape of AI technology.
